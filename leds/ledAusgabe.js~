var Gpio = require('pigpio').Gpio;

var ledRed = new Gpio(22, {mode:Gpio.OUTPUT});
var ledGreen = new Gpio(27, {mode: Gpio.OUTPUT});
var ledBlue = new Gpio(17, {mode: Gpio.OUTPUT});
var i = 0;
var j = 0;
var keepGoing = true;

module.exports = {
output: async function(input)
{
	for(var i = 0; i < input.length - 1; i++)
	{		
		switch(input[i].toString() + input[i+1].toString())
		{
			case ("00") :
				ledRed.pwmWrite(0);
				ledGreen.pwmWrite(0);
				ledBlue.pwmWrite(0);
				break;
			case ("01") :
				ledRed.pwmWrite(255);
				ledGreen.pwmWrite(0);
				ledBlue.pwmWrite(0);
				break;
			case ("10") :
				ledRed.pwmWrite(0);
				ledGreen.pwmWrite(255);
				ledBlue.pwmWrite(0);
				break;
			case ("11") :
				ledRed.pwmWrite(0);
				ledGreen.pwmWrite(0);
				ledBlue.pwmWrite(255);
				break;
			default :
				ledRed.pwmWrite(255);
				ledGreen.pwmWrite(255);
				ledBlue.pwmWrite(255);
				break;
		}
		i++;
/*                if(i == 0)
			{
				  ledRed.pwmWrite(255);
				  ledGreen.pwmWrite(255);
					ledBlue.pwmWrite(255);
					i = 1;
			}
			else
			{
					ledRed.pwmWrite(0);
					ledGreen.pwmWrite(0);
					ledBlue.pwmWrite(0);
					i = 0;
			}*/
//              console.log("Test: " + input[i]);
	await sleep (33);
	}
	ledRed.pwmWrite(0);
	ledGreen.pwmWrite(0);
	ledBlue.pwmWrite(0);
	console.log("Done");
}
};

setTimeout(function() {
    // this will be executed in 3 minutes
    // causing the following while loop to exit
    keepGoing = false;
}, 10000);

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

async function demo() {
  await sleep(1000);
}
